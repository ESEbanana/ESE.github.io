<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/ESE.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/ESE1.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="ESE's Note" type="application/atom+xml" />






<meta name="description" content="记录一下代码，方便使用">
<meta property="og:type" content="article">
<meta property="og:title" content="代码备份">
<meta property="og:url" content="http://yoursite.com/2017/12/05/re_code/index.html">
<meta property="og:site_name" content="ESE&#39;s Note">
<meta property="og:description" content="记录一下代码，方便使用">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-04-04T08:40:12.324Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="代码备份">
<meta name="twitter:description" content="记录一下代码，方便使用">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/12/05/re_code/"/>





  <title>代码备份 | ESE's Note</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ESE's Note</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">阅览室</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/12/05/re_code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ESE's Note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">代码备份</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-12-05T19:48:44+08:00">
                2017-12-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          
          作者：ESE

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>记录一下代码，方便使用<br><a id="more"></a></p>
<h1 id="1、java"><a href="#1、java" class="headerlink" title="1、java"></a>1、java</h1><h2 id="re4"><a href="#re4" class="headerlink" title="re4"></a>re4</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">HloveyRC4</span><span class="params">(String aInput,String aKey)</span>   </span></div><div class="line"><span class="function">   </span>&#123;   </div><div class="line">       <span class="keyword">int</span>[] iS = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">256</span>];   </div><div class="line">       <span class="keyword">byte</span>[] iK = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">256</span>];   </div><div class="line">         </div><div class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++)   </div><div class="line">           iS[i]=i;   </div><div class="line">             </div><div class="line">       <span class="keyword">int</span> j = <span class="number">1</span>;   </div><div class="line">         </div><div class="line">       <span class="keyword">for</span> (<span class="keyword">short</span> i= <span class="number">0</span>;i&lt;<span class="number">256</span>;i++)   </div><div class="line">       &#123;   </div><div class="line">           iK[i]=(<span class="keyword">byte</span>)aKey.charAt((i % aKey.length()));   </div><div class="line">       &#125;   </div><div class="line">         </div><div class="line">       j=<span class="number">0</span>;   </div><div class="line">         </div><div class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">255</span>;i++)   </div><div class="line">       &#123;   </div><div class="line">           j=(j+iS[i]+iK[i]) % <span class="number">256</span>;   </div><div class="line">           <span class="keyword">int</span> temp = iS[i];   </div><div class="line">           iS[i]=iS[j];   </div><div class="line">           iS[j]=temp;   </div><div class="line">       &#125;   </div><div class="line">     </div><div class="line">     </div><div class="line">       <span class="keyword">int</span> i=<span class="number">0</span>;   </div><div class="line">       j=<span class="number">0</span>;   </div><div class="line">       <span class="keyword">char</span>[] iInputChar = aInput.toCharArray();   </div><div class="line">       <span class="keyword">char</span>[] iOutputChar = <span class="keyword">new</span> <span class="keyword">char</span>[iInputChar.length];   </div><div class="line">       <span class="keyword">for</span>(<span class="keyword">short</span> x = <span class="number">0</span>;x&lt;iInputChar.length;x++)   </div><div class="line">       &#123;   </div><div class="line">           i = (i+<span class="number">1</span>) % <span class="number">256</span>;   </div><div class="line">           j = (j+iS[i]) % <span class="number">256</span>;   </div><div class="line">           <span class="keyword">int</span> temp = iS[i];   </div><div class="line">           iS[i]=iS[j];   </div><div class="line">           iS[j]=temp;   </div><div class="line">           <span class="keyword">int</span> t = (iS[i]+(iS[j] % <span class="number">256</span>)) % <span class="number">256</span>;   </div><div class="line">           <span class="keyword">int</span> iY = iS[t];   </div><div class="line">           <span class="keyword">char</span> iCY = (<span class="keyword">char</span>)iY;   </div><div class="line">           iOutputChar[x] =(<span class="keyword">char</span>)( iInputChar[x] ^ iCY) ;      </div><div class="line">       &#125;   </div><div class="line">         </div><div class="line">       <span class="keyword">return</span> <span class="keyword">new</span> String(iOutputChar);   </div><div class="line">                 </div><div class="line">   &#125;  </div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">	  String inputStr = <span class="string">"7894dsfdsdfsd"</span>;      </div><div class="line">	    String key = <span class="string">"abcdefg"</span>;         </div><div class="line">	      </div><div class="line">	    String str = HloveyRC4(inputStr,key);  </div><div class="line">	      </div><div class="line">	    <span class="comment">//打印加密后的字符串      </span></div><div class="line">	    System.out.println(str);    </div><div class="line">	      </div><div class="line">	    <span class="comment">//打印解密后的字符串      </span></div><div class="line">	    System.out.println(HloveyRC4(str,key));    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="byte和Strings互转"><a href="#byte和Strings互转" class="headerlink" title="byte和Strings互转"></a>byte和Strings互转</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">String str = &quot;hello&quot;;</div><div class="line">byte[] srtbyte = null;</div><div class="line">try &#123;</div><div class="line">	srtbyte = str.getBytes(&quot;UTF-8&quot;);</div><div class="line">	String res = new String(srtbyte,&quot;UTF-8&quot;);</div><div class="line">	System.out.println(res);</div><div class="line">    &#125; catch (UnsupportedEncodingException e) &#123;</div><div class="line">	e.printStackTrace();</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h1 id="2、python"><a href="#2、python" class="headerlink" title="2、python"></a>2、python</h1><p>8种排序，插入排序、希尔排序、冒泡排序、快速排序、直接选择排序、堆排序、归并排序、基数排序。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#直接爆破</span></div><div class="line"><span class="keyword">import</span> string </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">func1</span><span class="params">(n)</span>:</span></div><div class="line">	r = n</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">7</span>):</div><div class="line">		<span class="keyword">if</span> i&amp;<span class="number">1</span>:</div><div class="line">			r ^= <span class="number">1</span>&lt;&lt; i</div><div class="line">		<span class="keyword">else</span>:</div><div class="line">			r |= <span class="number">1</span>&lt;&lt; i</div><div class="line">	<span class="keyword">return</span> r</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">func2</span><span class="params">(n)</span>:</span></div><div class="line">	r = <span class="number">1</span></div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>):</div><div class="line">		r = (n*r)%<span class="number">481</span></div><div class="line">	<span class="keyword">return</span> r</div><div class="line">enc=[<span class="number">0x19C</span>,<span class="number">0x169</span>,<span class="number">0x30</span>,<span class="number">0x1D6</span>,<span class="number">0x30</span>,<span class="number">0x30</span>,<span class="number">0x199</span>,<span class="number">0x6A</span>,<span class="number">0x157</span>,<span class="number">0xc2</span>,</div><div class="line"><span class="number">0x10A</span>,<span class="number">0x155</span>,<span class="number">0x150</span>,<span class="number">0x107</span>,<span class="number">0x37</span>,<span class="number">0x12E</span>,<span class="number">0x22</span>,<span class="number">0x0F1</span>,<span class="number">0x1AE</span>,</div><div class="line"><span class="number">0x151</span>,<span class="number">0x0F1</span>,<span class="number">0x1A</span>,<span class="number">0x1A5</span>,<span class="number">0x1AE</span>,<span class="number">0x0C9</span>,<span class="number">0x12C</span>,<span class="number">0x1</span>,<span class="number">0x166</span>,<span class="number">0x12c</span>,</div><div class="line"><span class="number">0x0CB</span>,<span class="number">0x30</span>,<span class="number">0x107</span>,<span class="number">0x166</span>,<span class="number">0x1B4</span>,<span class="number">0x1AE</span>,<span class="number">0x14C</span>,<span class="number">0x46</span>]</div><div class="line">out =<span class="string">''</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</div><div class="line">	<span class="keyword">for</span> c <span class="keyword">in</span> string.printable:</div><div class="line">		s = ord(c) ^ func1(i)</div><div class="line">		s = func2(s)</div><div class="line">		<span class="keyword">if</span> s == enc[i]:</div><div class="line">			out+=c</div><div class="line">			<span class="keyword">break</span></div><div class="line"><span class="keyword">print</span> out</div><div class="line"></div><div class="line"><span class="comment">#插入排序,时间复杂度为O(n^2)。是稳定的排序方法。</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">insert_sort</span><span class="params">(lst)</span>:</span></div><div class="line">    count=len(lst)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,count):</div><div class="line">        key=lst[i]</div><div class="line">        j=i<span class="number">-1</span></div><div class="line">        <span class="keyword">while</span> j&gt;=<span class="number">0</span>:</div><div class="line">            <span class="keyword">if</span> lst[j]&gt;key:</div><div class="line">                lst[j+<span class="number">1</span>]=lst[j]</div><div class="line">                lst[j]=key</div><div class="line">            j-=<span class="number">1</span></div><div class="line">    <span class="keyword">return</span> lst</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 希尔排序是插入排序的一种希尔排序是非稳定排序算法</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">shell_sort</span><span class="params">(lst)</span>:</span></div><div class="line">    count = len(lst)</div><div class="line">    step = <span class="number">2</span></div><div class="line">    group = count / step</div><div class="line">    <span class="keyword">while</span> group &gt; <span class="number">0</span>:</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, group):</div><div class="line">            j = i + group</div><div class="line">            <span class="keyword">while</span> j &lt; count:</div><div class="line">                k = j - group</div><div class="line">                key = lst[j]</div><div class="line">                <span class="keyword">while</span> k &gt;= <span class="number">0</span>:</div><div class="line">                    <span class="keyword">if</span> lst[k] &gt; key:</div><div class="line">                        lst[k + group] = lst[k]</div><div class="line">                        lst[k] = key</div><div class="line">                    k -= group</div><div class="line">                j += group</div><div class="line">        group /= step</div><div class="line">    <span class="keyword">return</span> lst</div><div class="line"></div><div class="line"><span class="comment"># 冒泡排序</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">bubble_sort</span><span class="params">(lst)</span>:</span></div><div class="line">    count = len(lst)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, count):</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i + <span class="number">1</span>, count):</div><div class="line">            <span class="keyword">if</span> lst[i] &gt; lst[j]:</div><div class="line">                lst[i], lst[j] = lst[j], lst[i]</div><div class="line">    <span class="keyword">return</span> lst</div><div class="line"></div><div class="line"><span class="comment"># 选择排序</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">select_sort</span><span class="params">(lst)</span>:</span></div><div class="line">    count = len(lst)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, count):</div><div class="line">        min = i</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i + <span class="number">1</span>, count):</div><div class="line">            <span class="keyword">if</span> lst[min] &gt; lst[j]:</div><div class="line">                min = j</div><div class="line">        lst[min], lst[i] = lst[i], lst[min]</div><div class="line">    <span class="keyword">return</span> lst</div><div class="line"></div><div class="line"><span class="comment"># 快速排序,整个排序过程可以递归进行</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">quick_sort</span><span class="params">(lst, left, right)</span>:</span></div><div class="line">    <span class="keyword">if</span> left &gt;= right:</div><div class="line">        <span class="keyword">return</span> lst</div><div class="line">    key = lst[left]</div><div class="line">    low = left</div><div class="line">    high = right</div><div class="line">    <span class="keyword">while</span> left &lt; right:</div><div class="line">        <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> lst[right] &gt;= key:</div><div class="line">            right -= <span class="number">1</span></div><div class="line">        lst[left] = lst[right]</div><div class="line">        <span class="keyword">while</span> left &lt; right <span class="keyword">and</span> lst[left] &lt;= key:</div><div class="line">            left += <span class="number">1</span></div><div class="line">        lst[right] = lst[left]</div><div class="line">    lst[right] = key</div><div class="line">    quick_sort(lst, low, left - <span class="number">1</span>)</div><div class="line">    quick_sort(lst, left + <span class="number">1</span>, high)</div><div class="line">    <span class="keyword">return</span> lst</div><div class="line"></div><div class="line"><span class="comment">#堆排序是指利用堆积树数据结构,它是选择排序的一种,堆分为大根堆和小根堆，是完全二叉树,大根堆的要求是每个节点的值都不大于其父节点的值</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">adjust_heap</span><span class="params">(lst, i, size)</span>:</span></div><div class="line">    lchild = <span class="number">2</span> * i + <span class="number">1</span></div><div class="line">    rchild = <span class="number">2</span> * i + <span class="number">2</span></div><div class="line">    max = i</div><div class="line">    <span class="keyword">if</span> i &lt; size / <span class="number">2</span>:</div><div class="line">        <span class="keyword">if</span> lchild &lt; size <span class="keyword">and</span> lst[lchild] &gt; lst[max]:</div><div class="line">            max = lchild</div><div class="line">        <span class="keyword">if</span> rchild &lt; size <span class="keyword">and</span> lst[rchild] &gt; lst[max]:</div><div class="line">            max = rchild</div><div class="line">        <span class="keyword">if</span> max != i:</div><div class="line">            lst[max], lst[i] = lst[i], lst[max]</div><div class="line">            adjust_heap(lst, max, size)</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_heap</span><span class="params">(lst, size)</span>:</span></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, (size/<span class="number">2</span>))[::<span class="number">-1</span>]:</div><div class="line">        adjust_heap(lst, i, size)</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">heap_sort</span><span class="params">(lst)</span>:</span></div><div class="line">    size = len(lst)</div><div class="line">    build_heap(lst, size)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, size)[::<span class="number">-1</span>]:</div><div class="line">        lst[<span class="number">0</span>], lst[i] = lst[i], lst[<span class="number">0</span>]</div><div class="line">        adjust_heap(lst, <span class="number">0</span>, i)</div><div class="line"></div><div class="line"><span class="comment">#归并排序</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">merge</span><span class="params">(left, right)</span>:</span></div><div class="line">    i, j = <span class="number">0</span>, <span class="number">0</span></div><div class="line">    result = []</div><div class="line">    <span class="keyword">while</span> i &lt; len(left) <span class="keyword">and</span> j &lt; len(right):</div><div class="line">        <span class="keyword">if</span> left[i] &lt;= right[j]:</div><div class="line">            result.append(left[i])</div><div class="line">            i += <span class="number">1</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            result.append(right[j])</div><div class="line">            j += <span class="number">1</span></div><div class="line">    result += left[i:]</div><div class="line">    result += right[j:]</div><div class="line">    <span class="keyword">return</span> result</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">merge_sort</span><span class="params">(lst)</span>:</span></div><div class="line">    <span class="comment"># 归并排序</span></div><div class="line">    <span class="keyword">if</span> len(lst) &lt;= <span class="number">1</span>:</div><div class="line">        <span class="keyword">return</span> lst</div><div class="line">    num = len(lst) / <span class="number">2</span></div><div class="line">    left = merge_sort(lst[:num])</div><div class="line">    right = merge_sort(lst[num:])</div><div class="line"></div><div class="line"><span class="comment">#基数排序</span></div><div class="line"><span class="keyword">import</span> math</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">radix_sort</span><span class="params">(lst, radix=<span class="number">10</span>)</span>:</span></div><div class="line">    k = int(math.ceil(math.log(max(lst), radix)))</div><div class="line">    bucket = [[] <span class="keyword">for</span> i <span class="keyword">in</span> range(radix)]</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, k+<span class="number">1</span>):</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> lst:</div><div class="line">            bucket[j/(radix**(i<span class="number">-1</span>)) % (radix**i)].append(j)</div><div class="line">        <span class="keyword">del</span> lst[:]</div><div class="line">        <span class="keyword">for</span> z <span class="keyword">in</span> bucket:</div><div class="line">            lst += z</div><div class="line">            <span class="keyword">del</span> z[:]</div><div class="line">    <span class="keyword">return</span> lst</div></pre></td></tr></table></figure></p>
<h1 id="3、java-apk"><a href="#3、java-apk" class="headerlink" title="3、java(apk)"></a>3、java(apk)</h1><h2 id="1、将字符串写在strings-xml里面"><a href="#1、将字符串写在strings-xml里面" class="headerlink" title="1、将字符串写在strings.xml里面"></a>1、将字符串写在strings.xml里面</h2><p>开发<br>apk-&gt;app-&gt;src-&gt;main-&gt;res-&gt;values-&gt;strings.xml<br><code>&lt;string name=&quot;user_name&quot;&gt;ESE_1996&lt;/string&gt;</code><br><code>name.getText().toString().equals(getResources().getString(R.string.user_name))</code><br>做题<br>Resources-&gt;resources.arsc-&gt;res-&gt;values-&gt;string.xml</p>
<h1 id="4、C"><a href="#4、C" class="headerlink" title="4、C"></a>4、C</h1><h2 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;time.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;fcntl.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;sys/stat.h&gt; </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">( <span class="keyword">void</span> )</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    FILE *stream;</div><div class="line">    <span class="keyword">char</span> <span class="built_in">list</span>[<span class="number">20000</span>];</div><div class="line">    <span class="keyword">int</span> start,end,fd,size;</div><div class="line">    <span class="keyword">int</span> i, numread, numwritten;</div><div class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">20000</span>; i++ )</div><div class="line">        <span class="built_in">list</span>[i] = (<span class="keyword">char</span>)(<span class="string">'z'</span>);</div><div class="line">    start=clock();</div><div class="line">    <span class="keyword">if</span>( (stream = fopen( <span class="string">"fread.out"</span>, <span class="string">"w+t"</span> )) != <span class="literal">NULL</span> )  </div><div class="line">    &#123;</div><div class="line">        numwritten = fwrite( <span class="built_in">list</span>, <span class="keyword">sizeof</span>( <span class="keyword">char</span> ), <span class="number">20000</span>, stream );</div><div class="line">        fclose( stream );</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span></div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>( <span class="string">"Problem opening the file\n"</span> );</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>( (stream = fopen( <span class="string">"fread.out"</span>, <span class="string">"r+t"</span> )) != <span class="literal">NULL</span> )  </div><div class="line">    &#123;</div><div class="line">        numread = fread( <span class="built_in">list</span>, <span class="keyword">sizeof</span>( <span class="keyword">char</span> ), <span class="number">20000</span>, stream );</div><div class="line">        fclose( stream );</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span></div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>( <span class="string">"File could not be opened\n"</span> );</div><div class="line">    &#125;</div><div class="line">    end=clock();</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"fread all time：%d\n"</span>,end-start);</div><div class="line">    start=clock();</div><div class="line">    fd = open(<span class="string">"read.out"</span>, O_WRONLY|O_CREAT);</div><div class="line">    write(fd, <span class="built_in">list</span>, <span class="keyword">sizeof</span>(<span class="built_in">list</span>));</div><div class="line">    close(fd);</div><div class="line">    fd = open(<span class="string">"read.out"</span>, O_RDONLY);</div><div class="line">    size = read(fd, <span class="built_in">list</span>, <span class="keyword">sizeof</span>(<span class="built_in">list</span>));</div><div class="line">    close(fd);</div><div class="line">    end=clock();</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"read all time：%d\n"</span>,end-start);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;  </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;malloc.h&gt;  </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;  </span></span></div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">char</span> *<span class="title">base64_encode</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *src)</span></span>;  </div><div class="line"><span class="function"><span class="keyword">char</span> *<span class="title">base64_decode</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *src)</span></span>;  </div><div class="line">  </div><div class="line"><span class="keyword">char</span> *table=<span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"</span>;</div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">char</span> *<span class="title">base64_encode</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *src)</span>  </span></div><div class="line"><span class="function"></span>&#123;  </div><div class="line">    <span class="keyword">int</span> count;  </div><div class="line">    <span class="keyword">char</span> *dst;  </div><div class="line">    <span class="keyword">long</span> tmp, buf;  </div><div class="line">    <span class="keyword">char</span> in[<span class="number">4</span>];  </div><div class="line">  </div><div class="line">    <span class="keyword">int</span> i, j;  </div><div class="line">  </div><div class="line">    count = <span class="built_in">strlen</span>(src) / <span class="number">3</span> + (<span class="built_in">strlen</span>(src) % <span class="number">3</span> ? <span class="number">1</span> : <span class="number">0</span>);  </div><div class="line">    dst = (<span class="keyword">char</span>*)<span class="built_in">malloc</span>((count * <span class="number">4</span> + <span class="number">1</span>));  </div><div class="line">    <span class="built_in">memset</span>(dst, <span class="number">0</span>, count * <span class="number">4</span> + <span class="number">1</span>);  </div><div class="line">      </div><div class="line">  </div><div class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; count; j++)  </div><div class="line">    &#123;  </div><div class="line">        <span class="built_in">memset</span>(in, <span class="number">0</span>, <span class="keyword">sizeof</span>(in));  </div><div class="line">        <span class="built_in">strncpy</span>(in, src + j * <span class="number">3</span>, <span class="number">3</span>);  </div><div class="line">  </div><div class="line">        buf = <span class="number">0</span>;  </div><div class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(in); i++)  </div><div class="line">        &#123;  </div><div class="line">            tmp = (<span class="keyword">long</span>)in[i];  </div><div class="line">            tmp &lt;&lt;= (<span class="number">16</span> - i * <span class="number">8</span>);  </div><div class="line">            buf |= tmp;  </div><div class="line">        &#125;  </div><div class="line">  </div><div class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)  </div><div class="line">        &#123;  </div><div class="line">            <span class="keyword">if</span>(<span class="built_in">strlen</span>(in) + <span class="number">1</span> &gt; i)  </div><div class="line">            &#123;  </div><div class="line">                tmp = buf &gt;&gt; (<span class="number">18</span> - <span class="number">6</span> * i);  </div><div class="line">                tmp &amp;= <span class="number">0x3f</span>;  </div><div class="line">                dst[j * <span class="number">4</span> + i] = table[tmp];  </div><div class="line">            &#125;  </div><div class="line">            <span class="keyword">else</span>  </div><div class="line">            &#123;  </div><div class="line">                dst[j * <span class="number">4</span> + i] = <span class="string">'='</span>;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="keyword">return</span> dst;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">char</span> *<span class="title">base64_decode</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *src)</span>  </span></div><div class="line"><span class="function"></span>&#123;  </div><div class="line">    <span class="keyword">int</span> count, len;  </div><div class="line">    <span class="keyword">char</span> *dst;  </div><div class="line">      </div><div class="line">    <span class="keyword">long</span> tmp, buf;  </div><div class="line">    <span class="keyword">int</span> i, j, k;  </div><div class="line">    <span class="keyword">char</span> in[<span class="number">5</span>];  </div><div class="line">    len = <span class="built_in">strlen</span>(src);  </div><div class="line">    count = len / <span class="number">4</span>;  </div><div class="line">      </div><div class="line">    dst = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(count * <span class="number">3</span> + <span class="number">1</span>);  </div><div class="line">    <span class="built_in">memset</span>(dst, <span class="number">0</span>, count * <span class="number">3</span> + <span class="number">1</span>);  </div><div class="line">  </div><div class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; count; j++)  </div><div class="line">    &#123;  </div><div class="line">        <span class="built_in">memset</span>(in, <span class="number">0</span>, <span class="keyword">sizeof</span>(in));  </div><div class="line">        <span class="built_in">strncpy</span>(in, src + j * <span class="number">4</span>, <span class="number">4</span>);  </div><div class="line">  </div><div class="line">        buf = <span class="number">0</span>;  </div><div class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)  </div><div class="line">        &#123;  </div><div class="line">            tmp = (<span class="keyword">long</span>)in[i];  </div><div class="line">            <span class="keyword">if</span>(tmp == <span class="string">'='</span>)  </div><div class="line">            &#123;  </div><div class="line">                tmp = <span class="number">0</span>;  </div><div class="line">            &#125;  </div><div class="line">            <span class="keyword">else</span>  </div><div class="line">            &#123;  </div><div class="line">                <span class="keyword">for</span>(k = <span class="number">0</span>; ; k++)  </div><div class="line">                &#123;  </div><div class="line">                    <span class="keyword">if</span>(table[k] == tmp)  </div><div class="line">                        <span class="keyword">break</span>;  </div><div class="line">                &#125;  </div><div class="line">                tmp = k;  </div><div class="line">            &#125;  </div><div class="line">            tmp &lt;&lt;= (<span class="number">18</span> - i * <span class="number">6</span>);  </div><div class="line">            buf |= tmp;  </div><div class="line">              </div><div class="line">        &#125;  </div><div class="line">  </div><div class="line">        <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)  </div><div class="line">        &#123;  </div><div class="line">            tmp = buf &gt;&gt; (<span class="number">16</span> - i * <span class="number">8</span>);  </div><div class="line">            tmp &amp;= <span class="number">0xff</span>;  </div><div class="line">            dst[j * <span class="number">3</span> + i] = tmp;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="keyword">return</span> dst;  </div><div class="line">  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>  </span></div><div class="line"><span class="function"></span>&#123;  </div><div class="line">    <span class="keyword">char</span> *src, *dst;  </div><div class="line">    src = <span class="string">"flag&#123;y0u_knoW_Ba4e64&#125;"</span>;   </div><div class="line">    dst = base64_encode(src);  </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, dst);  </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, base64_decode(src));  </div><div class="line">    <span class="built_in">free</span>(src);</div><div class="line">    <span class="built_in">free</span>(dst);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="rc4"><a href="#rc4" class="headerlink" title="rc4"></a>rc4</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">char</span> secret[] = <span class="string">"\xf8\xae\xe7\xd0\x53\xff\x32\xe5\x05\x7e\xa2"</span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_init</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*s,<span class="keyword">unsigned</span> <span class="keyword">char</span>*key, <span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</div><div class="line">    <span class="comment">//char k[256]=&#123;0&#125;;</span></div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> k[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) &#123;</div><div class="line">        s[i]=i;</div><div class="line">        k[i]=key[i%Len];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">256</span>;i++) &#123;</div><div class="line">        j=(j+s[i]+k[i])%<span class="number">256</span>;</div><div class="line">        tmp=s[i];</div><div class="line">        s[i]=s[j];</div><div class="line">        s[j]=tmp;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">rc4_crypt</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>*s,<span class="keyword">unsigned</span> <span class="keyword">char</span>*Data,<span class="keyword">unsigned</span> <span class="keyword">long</span> Len)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>,t=<span class="number">0</span>;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> k=<span class="number">0</span>;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> tmp;</div><div class="line">    <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;Len;k++)</div><div class="line">    &#123;</div><div class="line">        i=(i+<span class="number">1</span>)%<span class="number">256</span>;</div><div class="line">        j=(j+s[i])%<span class="number">256</span>;</div><div class="line">        tmp=s[i];</div><div class="line">        s[i]=s[j];<span class="comment">//交?换?s[x]和¨ªs[y]</span></div><div class="line">        s[j]=tmp;</div><div class="line">        t=(s[i]+s[j])%<span class="number">256</span>;</div><div class="line">        Data[k]^=s[t];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">       </div><div class="line">    <span class="keyword">char</span> szKey[<span class="number">20</span>]=&#123;<span class="number">0</span>&#125;,szRC4[<span class="number">512</span>]=&#123;<span class="number">0</span>&#125;,IV[<span class="number">256</span>]=&#123;<span class="number">0</span>&#125;;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i=<span class="number">0</span>;</div><div class="line">    <span class="keyword">char</span> rc4key[<span class="number">256</span>] = <span class="string">"i_am_not_the_flag"</span>;</div><div class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"input Key\n"</span>);</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%11s"</span>,szKey);</div><div class="line">        <span class="built_in">strcpy</span>(szRC4,szKey);</div><div class="line">        rc4_init(IV,(<span class="keyword">char</span> *)rc4key,<span class="built_in">strlen</span>(rc4key));</div><div class="line">        rc4_crypt(IV,(<span class="keyword">char</span> *)szRC4,<span class="built_in">strlen</span>(szRC4));</div><div class="line">        <span class="keyword">if</span>(<span class="built_in">memcmp</span>(szRC4,secret,<span class="keyword">sizeof</span>(secret))==<span class="number">0</span>)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"flag&#123;%s&#125;\r\n"</span>,szKey);</div><div class="line">            <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"please reverse me!\r\n"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="rc5"><a href="#rc5" class="headerlink" title="rc5"></a>rc5</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></div><div class="line"><span class="keyword">int</span> w=<span class="number">16</span>;<span class="comment">//字长</span></div><div class="line"><span class="keyword">int</span> r=<span class="number">12</span>;<span class="comment">//12;//轮数12</span></div><div class="line"><span class="keyword">int</span> b=<span class="number">16</span>;<span class="comment">//密钥长度</span></div><div class="line"><span class="keyword">int</span> t=<span class="number">26</span>;<span class="comment">//2*r+2=12*2+2=26</span></div><div class="line"><span class="keyword">int</span> c=<span class="number">8</span>; <span class="comment">//b*8/w = 16*8/16</span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">int</span> FOURBYTEINT;<span class="comment">//四字节</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span> TWOBYTEINT;<span class="comment">//2字节</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">char</span> BYTE;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitialKey</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>* KeyK,<span class="keyword">int</span> b)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">generateChildKey</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>* KeyK,TWOBYTEINT* ChildKeyS)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Encipher</span><span class="params">(TWOBYTEINT* In,TWOBYTEINT* Out,TWOBYTEINT* S)</span></span>;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Decipher</span><span class="params">(TWOBYTEINT* In,TWOBYTEINT* Out,TWOBYTEINT* S)</span></span>;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> NoOfData  4</span></div><div class="line"><span class="comment">/**2、循环移位函数</span></div><div class="line"><span class="comment"> 由于在生成子密钥，加密，解密过程中都要进行循环移位，故要首先定义循环以为函数。</span></div><div class="line"><span class="comment"> * 循环左移和右移函数</span></div><div class="line"><span class="comment"> * x : 被循环的数</span></div><div class="line"><span class="comment"> * y : 将要循环的位数</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ROTL(x,y) (((x)<span class="meta-string">&lt;&lt;(y&amp;(w-1))) | ((x)&gt;&gt;(w-(y&amp;(w-1)))))</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ROTR(x,y) (((x)&gt;&gt;(y&amp;(w-1))) | ((x)&lt;&lt;(w-(y&amp;(w-1)))))</span></div><div class="line"></div><div class="line"><span class="comment">/**3、    初始密钥产生函数</span></div><div class="line"><span class="comment"> 生成一个初始的长度为b字节的密钥。</span></div><div class="line"><span class="comment"> 产生初始密钥的函数</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">InitialKey</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>* KeyK,<span class="keyword">int</span> b)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> i,j;</div><div class="line">    <span class="keyword">for</span>( i=<span class="number">0</span>;i&lt;b;i++)<span class="comment">//初始化</span></div><div class="line">    &#123;</div><div class="line">        KeyK[i]=<span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> intiSeed=<span class="number">3</span>;</div><div class="line">    KeyK[<span class="number">0</span>]=intiSeed;</div><div class="line">    <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;b;j++)<span class="comment">//生成</span></div><div class="line">    &#123;</div><div class="line">        KeyK[j] = (BYTE) ( ((<span class="keyword">int</span>)(<span class="built_in">pow</span>(<span class="number">3</span>,j))%(<span class="number">255</span>-j)));</div><div class="line">        <span class="comment">//KeyK[j] = (BYTE) ( ((int)(pow(double(3),j))%(255-j)));</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/**4、    密钥扩展函数</span></div><div class="line"><span class="comment"> 由于需加密r轮，每轮需要两个子密钥，所以需要密钥扩展函数根据初始密钥来扩展出2r+2个子密钥。</span></div><div class="line"><span class="comment"> 产生子密钥的函数</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">generateChildKey</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">char</span>* KeyK,TWOBYTEINT* ChildKeyS)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="comment">//const double e = 2.718281828459;</span></div><div class="line">    <span class="comment">//const double Phia = 1.618033988749;</span></div><div class="line">    <span class="keyword">int</span> PW = <span class="number">47073</span>;<span class="comment">//0xb7e1;</span></div><div class="line">    <span class="keyword">int</span> QW = <span class="number">40503</span>;<span class="comment">//0x9e37;//genggai</span></div><div class="line">    <span class="keyword">int</span> i;</div><div class="line">    TWOBYTEINT L[c];</div><div class="line">    <span class="comment">//初始化数组S</span></div><div class="line">    ChildKeyS[<span class="number">0</span>]=PW;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">1</span>;i&lt;t;i++)</div><div class="line">    &#123;</div><div class="line">        ChildKeyS[i]=(ChildKeyS[i<span class="number">-1</span>]+ QW);</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//将K数组转换为L数组</span></div><div class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;c;i++)<span class="comment">//初始化L数组c=8</span></div><div class="line">    &#123;</div><div class="line">        L[i]=<span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> u = w/<span class="number">8</span>;</div><div class="line">    <span class="keyword">for</span> (i=b<span class="number">-1</span>;i!=<span class="number">-1</span>; i--)<span class="comment">//转换，数组L每一元素长为32bit，数组K每一元素长为8bit</span></div><div class="line">    &#123;</div><div class="line">        L[i/u] = (L[i/u]&lt;&lt;<span class="number">8</span>)+KeyK[i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;c;i++)<span class="comment">//16进制输出gaidong</span></div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%.4X "</span>,L[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">    <span class="comment">//产生子密钥，存储在ChildKeyS中</span></div><div class="line">    TWOBYTEINT A,B,X,Y;</div><div class="line">    A=B=X=Y=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">3</span>*t;i++)</div><div class="line">    &#123;</div><div class="line">        X = ChildKeyS[A] = ROTL(ChildKeyS[A]+X+Y,<span class="number">3</span>);</div><div class="line">        A = (A+<span class="number">1</span>) % t;</div><div class="line">        Y = L[B] = ROTL(L[B]+X+Y,(X+Y));</div><div class="line">        B = (B+<span class="number">1</span>) % c;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;t;i++)<span class="comment">//16进制输出</span></div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%.4X "</span>,ChildKeyS[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">/**5、    加密函数</span></div><div class="line"><span class="comment"> 加密函数</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Encipher</span><span class="params">(TWOBYTEINT * In,TWOBYTEINT * Out,TWOBYTEINT* S)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    TWOBYTEINT X,Y; <span class="comment">//定义两个32位存储器</span></div><div class="line">    <span class="keyword">int</span> i,j;</div><div class="line">    <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;NoOfData;j+=<span class="number">2</span>)</div><div class="line">    &#123;</div><div class="line">        X = In[j]+S[<span class="number">0</span>];</div><div class="line">        Y = In[j+<span class="number">1</span>]+S[<span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span>( i=<span class="number">1</span>;i&lt;=r;i++)</div><div class="line">        &#123;</div><div class="line">            X=ROTL((X^Y),Y) + S[<span class="number">2</span>*i]; <span class="comment">//异或，循环移位，相加</span></div><div class="line">            Y=ROTL((Y^X),X) + S[<span class="number">2</span>*i+<span class="number">1</span>];</div><div class="line">        &#125;</div><div class="line">        Out[j]=X;</div><div class="line">        Out[j+<span class="number">1</span>]=Y; <span class="comment">//密文</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">/**6、    解密函数</span></div><div class="line"><span class="comment"> 解密函数</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Decipher</span><span class="params">(TWOBYTEINT* In,TWOBYTEINT* Out,TWOBYTEINT* S)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j;</div><div class="line">    TWOBYTEINT X,Y;</div><div class="line">    <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;NoOfData;j+=<span class="number">2</span>)</div><div class="line">    &#123;</div><div class="line">        X = In[j];</div><div class="line">        Y = In[j+<span class="number">1</span>];</div><div class="line">        <span class="keyword">for</span>(i=r;i&gt;<span class="number">0</span>;i--)</div><div class="line">        &#123;</div><div class="line"><span class="comment">//            Y = ROTR(Y-S[2*i+1],X)^X; //相减，循环移位，异或</span></div><div class="line"><span class="comment">//            X = ROTR(X-S[2*i],Y)^Y;</span></div><div class="line">            </div><div class="line"><span class="comment">//            Y = ROTR(Y-S[2*i+1],X)^X; //相减，循环移位，异或</span></div><div class="line"><span class="comment">//            X = ROTR(X-S[2*i],Y)^Y;</span></div><div class="line"><span class="comment">//            改为（对数据进行强制转换）：</span></div><div class="line">            Y = ROTR((<span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span>)(Y-S[<span class="number">2</span>*i+<span class="number">1</span>]),X)^X;</div><div class="line">            X = ROTR((<span class="keyword">unsigned</span> <span class="keyword">short</span> <span class="keyword">int</span>)(X-S[<span class="number">2</span>*i]),Y)^Y;</div><div class="line">        &#125;</div><div class="line">        Out[j]=X - S[<span class="number">0</span>];</div><div class="line">        Out[j+<span class="number">1</span>]=Y - S[<span class="number">1</span>]; <span class="comment">//明文</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**7、    主函数测试</span></div><div class="line"><span class="comment"> </span></div><div class="line"><span class="comment"> 主函数</span></div><div class="line"><span class="comment"> */</span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></div><div class="line"><span class="function"></span>&#123;</div><div class="line">    TWOBYTEINT ChildKeyS[<span class="number">2</span>*r+<span class="number">2</span>]; <span class="comment">//64bit</span></div><div class="line">    TWOBYTEINT ChildKey1[<span class="number">26</span>]=&#123;<span class="number">0x9b9a</span>&#125;;</div><div class="line">    <span class="comment">//&#123;0xe25b,0x4338,0x36ab,0xd59f,0x9b9a,0xc0f1,0xdc4f,</span></div><div class="line">    <span class="comment">// 0xc0d2,0xf03a,0xff5a,0x771f,0x5952,0xb797,0x28ad,</span></div><div class="line">    <span class="comment">//0x5c9a,0xfd9a,0xbd4b,0x3b12,0xd198,0x17f8,0x7f19,</span></div><div class="line">    <span class="comment">//0x458e,0x1629,0xaa8a,0xb609,0x9b3c&#125;;//&#123;123,434,1,123,1,34,123,56,123,8&#125;;</span></div><div class="line">    BYTE KeyK[b];<span class="comment">//8bit=byte</span></div><div class="line">    InitialKey(KeyK,b); <span class="comment">//生成初始密钥</span></div><div class="line">    <span class="keyword">int</span> k;</div><div class="line">    generateChildKey(KeyK,ChildKeyS); <span class="comment">//根据初始密钥生成子密钥</span></div><div class="line"><span class="comment">//    TWOBYTEINT Source[]=&#123;'1','2','1','1'&#125;;//测试明文</span></div><div class="line">    <span class="keyword">char</span> arr[] = <span class="string">"what can i do for you?"</span>;</div><div class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> ll = <span class="built_in">strlen</span>(arr);</div><div class="line">    <span class="keyword">int</span> m;</div><div class="line">    <span class="keyword">for</span> (m=<span class="number">0</span>; NoOfData * m &lt; ll; m++) &#123;</div><div class="line">        TWOBYTEINT Source[<span class="number">4</span>] = &#123;arr[<span class="number">4</span> * m], arr[<span class="number">4</span> * m + <span class="number">1</span>], arr[<span class="number">4</span> * m + <span class="number">2</span>], arr[<span class="number">4</span> * m + <span class="number">3</span>]&#125;;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"加密以前的明文:"</span>);</div><div class="line">        <span class="keyword">for</span> (k=<span class="number">0</span>;k&lt;NoOfData;k++)</div><div class="line">        &#123;</div><div class="line">            </div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%.4X "</span>,Source[k]); <span class="comment">//16进制输出</span></div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%c "</span>,Source[k]); <span class="comment">//16进制输出</span></div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">        TWOBYTEINT Dest[NoOfData]; <span class="comment">//用来存储密文</span></div><div class="line">        <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;<span class="number">26</span>;k++)</div><div class="line">        &#123;</div><div class="line">            ChildKey1[k]=ChildKeyS[k];<span class="comment">//如果此处自定义简单的数值为加密密钥，则可以解密出密文</span></div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%.4X "</span>,ChildKey1[k]);</div><div class="line">            </div><div class="line">        &#125;</div><div class="line">        Encipher(Source,Dest,ChildKey1); <span class="comment">//加密</span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"加密以后的密文:"</span>);</div><div class="line">        <span class="keyword">for</span> (k=<span class="number">0</span>;k&lt;NoOfData;k++)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%.4X "</span>,Dest[k]);</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%c "</span>,Dest[k]);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</div><div class="line">        TWOBYTEINT Data[NoOfData]=&#123;<span class="number">0</span>&#125;; <span class="comment">//用来存储解密后的密文</span></div><div class="line">        Decipher(Dest,Data,ChildKey1); <span class="comment">//解密</span></div><div class="line">        <span class="built_in">printf</span>(<span class="string">"解密以后的明文:"</span>);</div><div class="line">        <span class="keyword">for</span> (k=<span class="number">0</span>;k&lt;NoOfData;k++)</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%.4X "</span>,Data[k]);</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%c "</span>,Data[k]);</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"\n\n\n\n"</span>);</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">//printf("sizeof unsigned short int: %d",sizeof(unsigned short int));</span></div><div class="line">    system(<span class="string">"pause\n"</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="des"><a href="#des" class="headerlink" title="des"></a>des</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div><div class="line">316</div><div class="line">317</div><div class="line">318</div><div class="line">319</div><div class="line">320</div><div class="line">321</div><div class="line">322</div><div class="line">323</div><div class="line">324</div><div class="line">325</div><div class="line">326</div><div class="line">327</div><div class="line">328</div><div class="line">329</div><div class="line">330</div><div class="line">331</div><div class="line">332</div><div class="line">333</div><div class="line">334</div><div class="line">335</div><div class="line">336</div><div class="line">337</div><div class="line">338</div><div class="line">339</div><div class="line">340</div><div class="line">341</div><div class="line">342</div><div class="line">343</div><div class="line">344</div><div class="line">345</div><div class="line">346</div><div class="line">347</div><div class="line">348</div><div class="line">349</div><div class="line">350</div><div class="line">351</div><div class="line">352</div><div class="line">353</div><div class="line">354</div><div class="line">355</div><div class="line">356</div><div class="line">357</div><div class="line">358</div><div class="line">359</div><div class="line">360</div><div class="line">361</div><div class="line">362</div><div class="line">363</div><div class="line">364</div><div class="line">365</div><div class="line">366</div><div class="line">367</div><div class="line">368</div><div class="line">369</div><div class="line">370</div><div class="line">371</div><div class="line">372</div><div class="line">373</div><div class="line">374</div><div class="line">375</div><div class="line">376</div><div class="line">377</div><div class="line">378</div><div class="line">379</div><div class="line">380</div><div class="line">381</div><div class="line">382</div><div class="line">383</div><div class="line">384</div><div class="line">385</div><div class="line">386</div><div class="line">387</div><div class="line">388</div><div class="line">389</div><div class="line">390</div><div class="line">391</div><div class="line">392</div><div class="line">393</div><div class="line">394</div><div class="line">395</div><div class="line">396</div><div class="line">397</div><div class="line">398</div><div class="line">399</div><div class="line">400</div><div class="line">401</div><div class="line">402</div><div class="line">403</div><div class="line">404</div><div class="line">405</div><div class="line">406</div><div class="line">407</div><div class="line">408</div><div class="line">409</div><div class="line">410</div><div class="line">411</div><div class="line">412</div><div class="line">413</div><div class="line">414</div><div class="line">415</div><div class="line">416</div><div class="line">417</div><div class="line">418</div><div class="line">419</div><div class="line">420</div><div class="line">421</div><div class="line">422</div><div class="line">423</div><div class="line">424</div><div class="line">425</div><div class="line">426</div><div class="line">427</div><div class="line">428</div><div class="line">429</div><div class="line">430</div><div class="line">431</div><div class="line">432</div><div class="line">433</div><div class="line">434</div><div class="line">435</div><div class="line">436</div><div class="line">437</div><div class="line">438</div><div class="line">439</div><div class="line">440</div><div class="line">441</div><div class="line">442</div><div class="line">443</div><div class="line">444</div><div class="line">445</div><div class="line">446</div><div class="line">447</div><div class="line">448</div><div class="line">449</div><div class="line">450</div><div class="line">451</div><div class="line">452</div><div class="line">453</div><div class="line">454</div><div class="line">455</div><div class="line">456</div><div class="line">457</div><div class="line">458</div><div class="line">459</div><div class="line">460</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdio.h"</span>  </span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"memory.h"</span>  </span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"time.h"</span>  </span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"stdlib.h"</span>  </span></div><div class="line">  </div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PLAIN_FILE_OPEN_ERROR -1  </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> KEY_FILE_OPEN_ERROR -2  </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> CIPHER_FILE_OPEN_ERROR -3  </span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> OK 1   </span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> ElemType;  </div><div class="line"><span class="comment">//初始置换表IP  </span></div><div class="line"><span class="keyword">int</span> IP_Table[<span class="number">64</span>] = &#123;  <span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,  </div><div class="line">                                 <span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,  </div><div class="line">                                 <span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,  </div><div class="line">                                 <span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,  </div><div class="line">                                 <span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,<span class="number">0</span>,  </div><div class="line">                                 <span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,  </div><div class="line">                                 <span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,  </div><div class="line">                                 <span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>&#125;;   </div><div class="line"><span class="comment">//逆初始置换表IP^-1  </span></div><div class="line"><span class="keyword">int</span> IP_1_Table[<span class="number">64</span>] = &#123;<span class="number">39</span>,<span class="number">7</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">55</span>,<span class="number">23</span>,<span class="number">63</span>,<span class="number">31</span>,  </div><div class="line">           <span class="number">38</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">14</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">62</span>,<span class="number">30</span>,  </div><div class="line">           <span class="number">37</span>,<span class="number">5</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">53</span>,<span class="number">21</span>,<span class="number">61</span>,<span class="number">29</span>,  </div><div class="line">           <span class="number">36</span>,<span class="number">4</span>,<span class="number">44</span>,<span class="number">12</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">60</span>,<span class="number">28</span>,  </div><div class="line">           <span class="number">35</span>,<span class="number">3</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">19</span>,<span class="number">59</span>,<span class="number">27</span>,  </div><div class="line">           <span class="number">34</span>,<span class="number">2</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">18</span>,<span class="number">58</span>,<span class="number">26</span>,  </div><div class="line">           <span class="number">33</span>,<span class="number">1</span>,<span class="number">41</span>,<span class="number">9</span>,<span class="number">49</span>,<span class="number">17</span>,<span class="number">57</span>,<span class="number">25</span>,  </div><div class="line">           <span class="number">32</span>,<span class="number">0</span>,<span class="number">40</span>,<span class="number">8</span>,<span class="number">48</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">24</span>&#125;;  </div><div class="line">  </div><div class="line"><span class="comment">//扩充置换表E  </span></div><div class="line"><span class="keyword">int</span> E_Table[<span class="number">48</span>] = &#123;<span class="number">31</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>,  </div><div class="line">                  <span class="number">3</span>,  <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>,  </div><div class="line">                  <span class="number">7</span>,  <span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,  </div><div class="line">                  <span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,  </div><div class="line">                  <span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,  </div><div class="line">                  <span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,  </div><div class="line">                  <span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,  </div><div class="line">                  <span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>, <span class="number">0</span>&#125;;  </div><div class="line">  </div><div class="line"><span class="comment">//置换函数P  </span></div><div class="line"><span class="keyword">int</span> P_Table[<span class="number">32</span>] = &#123;<span class="number">15</span>,<span class="number">6</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">28</span>,<span class="number">11</span>,<span class="number">27</span>,<span class="number">16</span>,  </div><div class="line">                  <span class="number">0</span>,<span class="number">14</span>,<span class="number">22</span>,<span class="number">25</span>,<span class="number">4</span>,<span class="number">17</span>,<span class="number">30</span>,<span class="number">9</span>,  </div><div class="line">                  <span class="number">1</span>,<span class="number">7</span>,<span class="number">23</span>,<span class="number">13</span>,<span class="number">31</span>,<span class="number">26</span>,<span class="number">2</span>,<span class="number">8</span>,  </div><div class="line">                  <span class="number">18</span>,<span class="number">12</span>,<span class="number">29</span>,<span class="number">5</span>,<span class="number">21</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">24</span>&#125;;  </div><div class="line">  </div><div class="line"><span class="comment">//S盒  </span></div><div class="line"><span class="keyword">int</span> S[<span class="number">8</span>][<span class="number">4</span>][<span class="number">16</span>] =<span class="comment">//S1  </span></div><div class="line">            &#123;&#123;&#123;<span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>&#125;,  </div><div class="line">              &#123;<span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>&#125;,  </div><div class="line">                &#123;<span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>&#125;,  </div><div class="line">                &#123;<span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>&#125;&#125;,  </div><div class="line">                <span class="comment">//S2  </span></div><div class="line">              &#123;&#123;<span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>&#125;,  </div><div class="line">              &#123;<span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>&#125;,  </div><div class="line">              &#123;<span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>&#125;,  </div><div class="line">              &#123;<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>&#125;&#125;,  </div><div class="line">              <span class="comment">//S3  </span></div><div class="line">              &#123;&#123;<span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>&#125;,  </div><div class="line">              &#123;<span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>&#125;,  </div><div class="line">                &#123;<span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>&#125;,  </div><div class="line">              &#123;<span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>&#125;&#125;,  </div><div class="line">              <span class="comment">//S4  </span></div><div class="line">              &#123;&#123;<span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>&#125;,  </div><div class="line">              &#123;<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">9</span>&#125;,  </div><div class="line">              &#123;<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>&#125;,  </div><div class="line">              &#123;<span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>&#125;&#125;,  </div><div class="line">              <span class="comment">//S5  </span></div><div class="line">              &#123;&#123;<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>&#125;,  </div><div class="line">              &#123;<span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>&#125;,  </div><div class="line">              &#123;<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>&#125;,  </div><div class="line">              &#123;<span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>&#125;&#125;,  </div><div class="line">              <span class="comment">//S6  </span></div><div class="line">              &#123;&#123;<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>&#125;,  </div><div class="line">              &#123;<span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>&#125;,  </div><div class="line">              &#123;<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>&#125;,  </div><div class="line">              &#123;<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>&#125;&#125;,  </div><div class="line">              <span class="comment">//S7  </span></div><div class="line">              &#123;&#123;<span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>&#125;,  </div><div class="line">              &#123;<span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>&#125;,  </div><div class="line">              &#123;<span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>&#125;,  </div><div class="line">              &#123;<span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>&#125;&#125;,  </div><div class="line">              <span class="comment">//S8  </span></div><div class="line">              &#123;&#123;<span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>&#125;,  </div><div class="line">              &#123;<span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>&#125;,  </div><div class="line">              &#123;<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>&#125;,  </div><div class="line">              &#123;<span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>&#125;&#125;&#125;;  </div><div class="line"><span class="comment">//置换选择1  </span></div><div class="line"><span class="keyword">int</span> PC_1[<span class="number">56</span>] = &#123;<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,  </div><div class="line">              <span class="number">0</span>,<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,  </div><div class="line">              <span class="number">9</span>,<span class="number">1</span>,<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,  </div><div class="line">              <span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,  </div><div class="line">              <span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,  </div><div class="line">              <span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,  </div><div class="line">              <span class="number">13</span>,<span class="number">5</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,  </div><div class="line">              <span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>&#125;;  </div><div class="line">  </div><div class="line"><span class="comment">//置换选择2  </span></div><div class="line"><span class="keyword">int</span> PC_2[<span class="number">48</span>] = &#123;<span class="number">13</span>,<span class="number">16</span>,<span class="number">10</span>,<span class="number">23</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">27</span>,  </div><div class="line">              <span class="number">14</span>,<span class="number">5</span>,<span class="number">20</span>,<span class="number">9</span>,<span class="number">22</span>,<span class="number">18</span>,<span class="number">11</span>,<span class="number">3</span>,  </div><div class="line">              <span class="number">25</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">26</span>,<span class="number">19</span>,<span class="number">12</span>,<span class="number">1</span>,  </div><div class="line">              <span class="number">40</span>,<span class="number">51</span>,<span class="number">30</span>,<span class="number">36</span>,<span class="number">46</span>,<span class="number">54</span>,<span class="number">29</span>,<span class="number">39</span>,  </div><div class="line">              <span class="number">50</span>,<span class="number">44</span>,<span class="number">32</span>,<span class="number">46</span>,<span class="number">43</span>,<span class="number">48</span>,<span class="number">38</span>,<span class="number">55</span>,  </div><div class="line">              <span class="number">33</span>,<span class="number">52</span>,<span class="number">45</span>,<span class="number">41</span>,<span class="number">49</span>,<span class="number">35</span>,<span class="number">28</span>,<span class="number">31</span>&#125;;  </div><div class="line">  </div><div class="line"><span class="comment">//对左移次数的规定  </span></div><div class="line"><span class="keyword">int</span> MOVE_TIMES[<span class="number">16</span>] = &#123;<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>&#125;;  </div><div class="line"></div><div class="line"><span class="comment">//字节转换成二进制  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ByteToBit</span><span class="params">(ElemType ch, ElemType bit[<span class="number">8</span>])</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>;cnt &lt; <span class="number">8</span>; cnt++)&#123;  </div><div class="line">        *(bit+cnt) = (ch&gt;&gt;cnt)&amp;<span class="number">1</span>;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//二进制转换成字节  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">BitToByte</span><span class="params">(ElemType bit[<span class="number">8</span>],ElemType *ch)</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>;cnt &lt; <span class="number">8</span>; cnt++)&#123;  </div><div class="line">        *ch |= *(bit + cnt)&lt;&lt;cnt;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//将长度为8的字符串转为二进制位串  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Char8ToBit64</span><span class="params">(ElemType ch[<span class="number">8</span>],ElemType bit[<span class="number">64</span>])</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">8</span>; cnt++)&#123;          </div><div class="line">        ByteToBit(*(ch+cnt),bit+(cnt&lt;&lt;<span class="number">3</span>));  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//将二进制位串转为长度为8的字符串  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">Bit64ToChar8</span><span class="params">(ElemType bit[<span class="number">64</span>],ElemType ch[<span class="number">8</span>])</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    <span class="built_in">memset</span>(ch,<span class="number">0</span>,<span class="number">8</span>);  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">8</span>; cnt++)&#123;  </div><div class="line">        BitToByte(bit+(cnt&lt;&lt;<span class="number">3</span>),ch+cnt);  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//生成子密钥  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_MakeSubKeys</span><span class="params">(ElemType key[<span class="number">64</span>],ElemType subKeys[<span class="number">16</span>][<span class="number">48</span>])</span></span>&#123;  </div><div class="line">    ElemType temp[<span class="number">56</span>];  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    DES_PC1_Transform(key,temp);<span class="comment">//PC1置换  </span></div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">16</span>; cnt++)&#123;<span class="comment">//16轮跌代，产生16个子密钥  </span></div><div class="line">        DES_ROL(temp,MOVE_TIMES[cnt]);<span class="comment">//循环左移  </span></div><div class="line">        DES_PC2_Transform(temp,subKeys[cnt]);<span class="comment">//PC2置换，产生子密钥  </span></div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//密钥置换1  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_PC1_Transform</span><span class="params">(ElemType key[<span class="number">64</span>], ElemType tempbts[<span class="number">56</span>])</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;      </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">56</span>; cnt++)&#123;  </div><div class="line">        tempbts[cnt] = key[PC_1[cnt]];  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//密钥置换2  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_PC2_Transform</span><span class="params">(ElemType key[<span class="number">56</span>], ElemType tempbts[<span class="number">48</span>])</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">48</span>; cnt++)&#123;  </div><div class="line">        tempbts[cnt] = key[PC_2[cnt]];  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//循环左移  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_ROL</span><span class="params">(ElemType data[<span class="number">56</span>], <span class="keyword">int</span> time)</span></span>&#123;     </div><div class="line">    ElemType temp[<span class="number">56</span>];  </div><div class="line">  </div><div class="line">    <span class="comment">//保存将要循环移动到右边的位  </span></div><div class="line">    <span class="built_in">memcpy</span>(temp,data,time);  </div><div class="line">    <span class="built_in">memcpy</span>(temp+time,data+<span class="number">28</span>,time);  </div><div class="line">      </div><div class="line">    <span class="comment">//前28位移动  </span></div><div class="line">    <span class="built_in">memcpy</span>(data,data+time,<span class="number">28</span>-time);  </div><div class="line">    <span class="built_in">memcpy</span>(data+<span class="number">28</span>-time,temp,time);  </div><div class="line">  </div><div class="line">    <span class="comment">//后28位移动  </span></div><div class="line">    <span class="built_in">memcpy</span>(data+<span class="number">28</span>,data+<span class="number">28</span>+time,<span class="number">28</span>-time);  </div><div class="line">    <span class="built_in">memcpy</span>(data+<span class="number">56</span>-time,temp+time,time);      </div><div class="line">  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//IP置换  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_IP_Transform</span><span class="params">(ElemType data[<span class="number">64</span>])</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    ElemType temp[<span class="number">64</span>];  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">64</span>; cnt++)&#123;  </div><div class="line">        temp[cnt] = data[IP_Table[cnt]];  </div><div class="line">    &#125;  </div><div class="line">    <span class="built_in">memcpy</span>(data,temp,<span class="number">64</span>);  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//IP逆置换  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_IP_1_Transform</span><span class="params">(ElemType data[<span class="number">64</span>])</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    ElemType temp[<span class="number">64</span>];  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">64</span>; cnt++)&#123;  </div><div class="line">        temp[cnt] = data[IP_1_Table[cnt]];  </div><div class="line">    &#125;  </div><div class="line">    <span class="built_in">memcpy</span>(data,temp,<span class="number">64</span>);  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//扩展置换  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_E_Transform</span><span class="params">(ElemType data[<span class="number">48</span>])</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    ElemType temp[<span class="number">48</span>];  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">48</span>; cnt++)&#123;  </div><div class="line">        temp[cnt] = data[E_Table[cnt]];  </div><div class="line">    &#125;     </div><div class="line">    <span class="built_in">memcpy</span>(data,temp,<span class="number">48</span>);  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//P置换  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_P_Transform</span><span class="params">(ElemType data[<span class="number">32</span>])</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    ElemType temp[<span class="number">32</span>];  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">32</span>; cnt++)&#123;  </div><div class="line">        temp[cnt] = data[P_Table[cnt]];  </div><div class="line">    &#125;     </div><div class="line">    <span class="built_in">memcpy</span>(data,temp,<span class="number">32</span>);  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//异或  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_XOR</span><span class="params">(ElemType R[<span class="number">48</span>], ElemType L[<span class="number">48</span>] ,<span class="keyword">int</span> count)</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; count; cnt++)&#123;  </div><div class="line">        R[cnt] ^= L[cnt];  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//S盒置换  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_SBOX</span><span class="params">(ElemType data[<span class="number">48</span>])</span></span>&#123;  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">    <span class="keyword">int</span> line,row,output;  </div><div class="line">    <span class="keyword">int</span> cur1,cur2;  </div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">8</span>; cnt++)&#123;  </div><div class="line">        cur1 = cnt*<span class="number">6</span>;  </div><div class="line">        cur2 = cnt&lt;&lt;<span class="number">2</span>;  </div><div class="line">          </div><div class="line">        <span class="comment">//计算在S盒中的行与列  </span></div><div class="line">        line = (data[cur1]&lt;&lt;<span class="number">1</span>) + data[cur1+<span class="number">5</span>];  </div><div class="line">        row = (data[cur1+<span class="number">1</span>]&lt;&lt;<span class="number">3</span>) + (data[cur1+<span class="number">2</span>]&lt;&lt;<span class="number">2</span>)  </div><div class="line">            + (data[cur1+<span class="number">3</span>]&lt;&lt;<span class="number">1</span>) + data[cur1+<span class="number">4</span>];  </div><div class="line">        output = S[cnt][line][row];  </div><div class="line">  </div><div class="line">        <span class="comment">//化为2进制  </span></div><div class="line">        data[cur2] = (output&amp;<span class="number">0X08</span>)&gt;&gt;<span class="number">3</span>;  </div><div class="line">        data[cur2+<span class="number">1</span>] = (output&amp;<span class="number">0X04</span>)&gt;&gt;<span class="number">2</span>;  </div><div class="line">        data[cur2+<span class="number">2</span>] = (output&amp;<span class="number">0X02</span>)&gt;&gt;<span class="number">1</span>;  </div><div class="line">        data[cur2+<span class="number">3</span>] = output&amp;<span class="number">0x01</span>;  </div><div class="line">    &#125;     </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//交换  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_Swap</span><span class="params">(ElemType left[<span class="number">32</span>], ElemType right[<span class="number">32</span>])</span></span>&#123;  </div><div class="line">    ElemType temp[<span class="number">32</span>];  </div><div class="line">    <span class="built_in">memcpy</span>(temp,left,<span class="number">32</span>);     </div><div class="line">    <span class="built_in">memcpy</span>(left,right,<span class="number">32</span>);    </div><div class="line">    <span class="built_in">memcpy</span>(right,temp,<span class="number">32</span>);  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//加密单个分组  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_EncryptBlock</span><span class="params">(ElemType plainBlock[<span class="number">8</span>], ElemType subKeys[<span class="number">16</span>][<span class="number">48</span>], ElemType cipherBlock[<span class="number">8</span>])</span></span>&#123;  </div><div class="line">    ElemType plainBits[<span class="number">64</span>];  </div><div class="line">    ElemType copyRight[<span class="number">48</span>];  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">  </div><div class="line">    Char8ToBit64(plainBlock,plainBits);       </div><div class="line">    <span class="comment">//初始置换（IP置换）  </span></div><div class="line">    DES_IP_Transform(plainBits);  </div><div class="line">  </div><div class="line">    <span class="comment">//16轮迭代  </span></div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">0</span>; cnt &lt; <span class="number">16</span>; cnt++)&#123;         </div><div class="line">        <span class="built_in">memcpy</span>(copyRight,plainBits+<span class="number">32</span>,<span class="number">32</span>);  </div><div class="line">        <span class="comment">//将右半部分进行扩展置换，从32位扩展到48位  </span></div><div class="line">        DES_E_Transform(copyRight);  </div><div class="line">        <span class="comment">//将右半部分与子密钥进行异或操作  </span></div><div class="line">        DES_XOR(copyRight,subKeys[cnt],<span class="number">48</span>);   </div><div class="line">        <span class="comment">//异或结果进入S盒，输出32位结果  </span></div><div class="line">        DES_SBOX(copyRight);  </div><div class="line">        <span class="comment">//P置换  </span></div><div class="line">        DES_P_Transform(copyRight);  </div><div class="line">        <span class="comment">//将明文左半部分与右半部分进行异或  </span></div><div class="line">        DES_XOR(plainBits,copyRight,<span class="number">32</span>);  </div><div class="line">        <span class="keyword">if</span>(cnt != <span class="number">15</span>)&#123;  </div><div class="line">            <span class="comment">//最终完成左右部的交换  </span></div><div class="line">            DES_Swap(plainBits,plainBits+<span class="number">32</span>);  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">//逆初始置换（IP^1置换）  </span></div><div class="line">    DES_IP_1_Transform(plainBits);  </div><div class="line">    Bit64ToChar8(plainBits,cipherBlock);  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//解密单个分组  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_DecryptBlock</span><span class="params">(ElemType cipherBlock[<span class="number">8</span>], ElemType subKeys[<span class="number">16</span>][<span class="number">48</span>],ElemType plainBlock[<span class="number">8</span>])</span></span>&#123;  </div><div class="line">    ElemType cipherBits[<span class="number">64</span>];  </div><div class="line">    ElemType copyRight[<span class="number">48</span>];  </div><div class="line">    <span class="keyword">int</span> cnt;  </div><div class="line">  </div><div class="line">    Char8ToBit64(cipherBlock,cipherBits);         </div><div class="line">    <span class="comment">//初始置换（IP置换）  </span></div><div class="line">    DES_IP_Transform(cipherBits);  </div><div class="line">      </div><div class="line">    <span class="comment">//16轮迭代  </span></div><div class="line">    <span class="keyword">for</span>(cnt = <span class="number">15</span>; cnt &gt;= <span class="number">0</span>; cnt--)&#123;        </div><div class="line">        <span class="built_in">memcpy</span>(copyRight,cipherBits+<span class="number">32</span>,<span class="number">32</span>);  </div><div class="line">        <span class="comment">//将右半部分进行扩展置换，从32位扩展到48位  </span></div><div class="line">        DES_E_Transform(copyRight);  </div><div class="line">        <span class="comment">//将右半部分与子密钥进行异或操作  </span></div><div class="line">        DES_XOR(copyRight,subKeys[cnt],<span class="number">48</span>);       </div><div class="line">        <span class="comment">//异或结果进入S盒，输出32位结果  </span></div><div class="line">        DES_SBOX(copyRight);  </div><div class="line">        <span class="comment">//P置换  </span></div><div class="line">        DES_P_Transform(copyRight);       </div><div class="line">        <span class="comment">//将明文左半部分与右半部分进行异或  </span></div><div class="line">        DES_XOR(cipherBits,copyRight,<span class="number">32</span>);  </div><div class="line">        <span class="keyword">if</span>(cnt != <span class="number">0</span>)&#123;  </div><div class="line">            <span class="comment">//最终完成左右部的交换  </span></div><div class="line">            DES_Swap(cipherBits,cipherBits+<span class="number">32</span>);  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">//逆初始置换（IP^1置换）  </span></div><div class="line">    DES_IP_1_Transform(cipherBits);  </div><div class="line">    Bit64ToChar8(cipherBits,plainBlock);  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//加密文件  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_Encrypt</span><span class="params">(<span class="keyword">char</span> *plainFile, <span class="keyword">char</span> *keyStr,<span class="keyword">char</span> *cipherFile)</span></span>&#123;  </div><div class="line">    FILE *plain,*cipher;  </div><div class="line">    <span class="keyword">int</span> count;  </div><div class="line">    ElemType plainBlock[<span class="number">8</span>],cipherBlock[<span class="number">8</span>],keyBlock[<span class="number">8</span>];  </div><div class="line">    ElemType bKey[<span class="number">64</span>];  </div><div class="line">    ElemType subKeys[<span class="number">16</span>][<span class="number">48</span>];  </div><div class="line">    <span class="keyword">if</span>((plain = fopen(plainFile,<span class="string">"rb"</span>)) == <span class="literal">NULL</span>)&#123;  </div><div class="line">        <span class="keyword">return</span> PLAIN_FILE_OPEN_ERROR;  </div><div class="line">    &#125;     </div><div class="line">    <span class="keyword">if</span>((cipher = fopen(cipherFile,<span class="string">"wb"</span>)) == <span class="literal">NULL</span>)&#123;  </div><div class="line">        <span class="keyword">return</span> CIPHER_FILE_OPEN_ERROR;  </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">//设置密钥  </span></div><div class="line">    <span class="built_in">memcpy</span>(keyBlock,keyStr,<span class="number">8</span>);  </div><div class="line">    <span class="comment">//将密钥转换为二进制流  </span></div><div class="line">    Char8ToBit64(keyBlock,bKey);  </div><div class="line">    <span class="comment">//生成子密钥  </span></div><div class="line">    DES_MakeSubKeys(bKey,subKeys);  </div><div class="line">      </div><div class="line">    <span class="keyword">while</span>(!feof(plain))&#123;  </div><div class="line">        <span class="comment">//每次读8个字节，并返回成功读取的字节数  </span></div><div class="line">        <span class="keyword">if</span>((count = fread(plainBlock,<span class="keyword">sizeof</span>(<span class="keyword">char</span>),<span class="number">8</span>,plain)) == <span class="number">8</span>)&#123;  </div><div class="line">            DES_EncryptBlock(plainBlock,subKeys,cipherBlock);  </div><div class="line">            fwrite(cipherBlock,<span class="keyword">sizeof</span>(<span class="keyword">char</span>),<span class="number">8</span>,cipher);    </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">if</span>(count)&#123;  </div><div class="line">        <span class="comment">//填充  </span></div><div class="line">        <span class="built_in">memset</span>(plainBlock + count,<span class="string">'\0'</span>,<span class="number">7</span> - count);  </div><div class="line">        <span class="comment">//最后一个字符保存包括最后一个字符在内的所填充的字符数量  </span></div><div class="line">        plainBlock[<span class="number">7</span>] = <span class="number">8</span> - count;  </div><div class="line">        DES_EncryptBlock(plainBlock,subKeys,cipherBlock);  </div><div class="line">        fwrite(cipherBlock,<span class="keyword">sizeof</span>(<span class="keyword">char</span>),<span class="number">8</span>,cipher);  </div><div class="line">    &#125;  </div><div class="line">    fclose(plain);  </div><div class="line">    fclose(cipher);  </div><div class="line">    <span class="keyword">return</span> OK;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="comment">//解密文件  </span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">DES_Decrypt</span><span class="params">(<span class="keyword">char</span> *cipherFile, <span class="keyword">char</span> *keyStr,<span class="keyword">char</span> *plainFile)</span></span>&#123;  </div><div class="line">    FILE *plain, *cipher;  </div><div class="line">    <span class="keyword">int</span> count,times = <span class="number">0</span>;  </div><div class="line">    <span class="keyword">long</span> fileLen;  </div><div class="line">    ElemType plainBlock[<span class="number">8</span>],cipherBlock[<span class="number">8</span>],keyBlock[<span class="number">8</span>];  </div><div class="line">    ElemType bKey[<span class="number">64</span>];  </div><div class="line">    ElemType subKeys[<span class="number">16</span>][<span class="number">48</span>];  </div><div class="line">    <span class="keyword">if</span>((cipher = fopen(cipherFile,<span class="string">"rb"</span>)) == <span class="literal">NULL</span>)&#123;  </div><div class="line">        <span class="keyword">return</span> CIPHER_FILE_OPEN_ERROR;  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">if</span>((plain = fopen(plainFile,<span class="string">"wb"</span>)) == <span class="literal">NULL</span>)&#123;  </div><div class="line">        <span class="keyword">return</span> PLAIN_FILE_OPEN_ERROR;  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    <span class="comment">//设置密钥  </span></div><div class="line">    <span class="built_in">memcpy</span>(keyBlock,keyStr,<span class="number">8</span>);  </div><div class="line">    <span class="comment">//将密钥转换为二进制流  </span></div><div class="line">    Char8ToBit64(keyBlock,bKey);  </div><div class="line">    <span class="comment">//生成子密钥  </span></div><div class="line">    DES_MakeSubKeys(bKey,subKeys);  </div><div class="line">  </div><div class="line">    <span class="comment">//取文件长度   </span></div><div class="line">    fseek(cipher,<span class="number">0</span>,SEEK_END);   <span class="comment">//将文件指针置尾  </span></div><div class="line">    fileLen = ftell(cipher);    <span class="comment">//取文件指针当前位置  </span></div><div class="line">    rewind(cipher);             <span class="comment">//将文件指针重指向文件头  </span></div><div class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;  </div><div class="line">        <span class="comment">//密文的字节数一定是8的整数倍  </span></div><div class="line">        fread(cipherBlock,<span class="keyword">sizeof</span>(<span class="keyword">char</span>),<span class="number">8</span>,cipher);  </div><div class="line">        DES_DecryptBlock(cipherBlock,subKeys,plainBlock);                         </div><div class="line">        times += <span class="number">8</span>;  </div><div class="line">        <span class="keyword">if</span>(times &lt; fileLen)&#123;  </div><div class="line">            fwrite(plainBlock,<span class="keyword">sizeof</span>(<span class="keyword">char</span>),<span class="number">8</span>,plain);  </div><div class="line">        &#125;  </div><div class="line">        <span class="keyword">else</span>&#123;  </div><div class="line">            <span class="keyword">break</span>;  </div><div class="line">        &#125;  </div><div class="line">    &#125;  </div><div class="line">    <span class="comment">//判断末尾是否被填充  </span></div><div class="line">    <span class="keyword">if</span>(plainBlock[<span class="number">7</span>] &lt; <span class="number">8</span>)&#123;  </div><div class="line">        <span class="keyword">for</span>(count = <span class="number">8</span> - plainBlock[<span class="number">7</span>]; count &lt; <span class="number">7</span>; count++)&#123;  </div><div class="line">            <span class="keyword">if</span>(plainBlock[count] != <span class="string">'\0'</span>)&#123;  </div><div class="line">                <span class="keyword">break</span>;  </div><div class="line">            &#125;  </div><div class="line">        &#125;  </div><div class="line">    &#125;     </div><div class="line">    <span class="keyword">if</span>(count == <span class="number">7</span>)&#123;<span class="comment">//有填充  </span></div><div class="line">        fwrite(plainBlock,<span class="keyword">sizeof</span>(<span class="keyword">char</span>),<span class="number">8</span> - plainBlock[<span class="number">7</span>],plain);  </div><div class="line">    &#125;  </div><div class="line">    <span class="keyword">else</span>&#123;<span class="comment">//无填充  </span></div><div class="line">        fwrite(plainBlock,<span class="keyword">sizeof</span>(<span class="keyword">char</span>),<span class="number">8</span>,plain);  </div><div class="line">    &#125;  </div><div class="line">  </div><div class="line">    fclose(plain);  </div><div class="line">    fclose(cipher);  </div><div class="line">    <span class="keyword">return</span> OK;  </div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>  </span></div><div class="line"><span class="function"></span>&#123;     </div><div class="line">    <span class="keyword">clock_t</span> a,b;  </div><div class="line">    a = clock();  </div><div class="line">    DES_Encrypt(<span class="string">"flag.txt"</span>,<span class="string">"key.txt"</span>,<span class="string">"2.txt"</span>);  </div><div class="line">    b = clock();  </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"加密消耗%d毫秒\n"</span>,b-a);  </div><div class="line">      </div><div class="line">    system(<span class="string">"pause"</span>);  </div><div class="line">    a = clock();  </div><div class="line">    DES_Decrypt(<span class="string">"2.txt"</span>,<span class="string">"key.txt"</span>,<span class="string">"3.txt"</span>);  </div><div class="line">    b = clock();  </div><div class="line">    <span class="built_in">printf</span>(<span class="string">"解密消耗%d毫秒\n"</span>,b-a);  </div><div class="line">    getchar();  </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>
    
    
    

    <div>
      
        
      
    </div>
    

    

    

    <div>
     
      <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>
      
    </div>

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/12/04/2017_12_24_miac_xianxia/" rel="next" title="第四届MIAC线下总结">
                <i class="fa fa-chevron-left"></i> 第四届MIAC线下总结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/12/11/2017_12_11_zjgsctf_re_wp/" rel="prev" title="悄悄的wp">
                悄悄的wp <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/saucxs/" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://weibo.com/" target="_blank" title="Twitter">
                    
                      <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/ese-76-83/activities" target="_blank" title="Zhihu">
                    
                      <i class="fa fa-fw fa-drupal"></i>Zhihu</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://weibo.com/5899672336/profile?topnav=1&wvr=6/&is_all=1" target="_blank" title="Weibo">
                    
                      <i class="fa fa-fw fa-weibo"></i>Weibo</a>
                </span>
              
            
          </div>

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-globe"></i>
                
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.betamao.me/" title="betamao" target="_blank">betamao</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://err0rzz.github.io/" title="err0rzz" target="_blank">err0rzz</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://veritas501.space/" title="Veritas501" target="_blank">Veritas501</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.bendawang.site/" title="Bendawang" target="_blank">Bendawang</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://lalajun.github.io/" title="lalajun" target="_blank">lalajun</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://bestwing.me/" title="swing" target="_blank">swing</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://b3t4m3ee.github.io/" title="b3t4m3ee" target="_blank">b3t4m3ee</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://myblackmanba.github.io/" title="black" target="_blank">black</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.baidu.com" title="百度一下" target="_blank">百度一下</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1、java"><span class="nav-number">1.</span> <span class="nav-text">1、java</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#re4"><span class="nav-number">1.1.</span> <span class="nav-text">re4</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#byte和Strings互转"><span class="nav-number">1.2.</span> <span class="nav-text">byte和Strings互转</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2、python"><span class="nav-number">2.</span> <span class="nav-text">2、python</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3、java-apk"><span class="nav-number">3.</span> <span class="nav-text">3、java(apk)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、将字符串写在strings-xml里面"><span class="nav-number">3.1.</span> <span class="nav-text">1、将字符串写在strings.xml里面</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4、C"><span class="nav-number">4.</span> <span class="nav-text">4、C</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#读取文件"><span class="nav-number">4.1.</span> <span class="nav-text">读取文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#base64"><span class="nav-number">4.2.</span> <span class="nav-text">base64</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rc4"><span class="nav-number">4.3.</span> <span class="nav-text">rc4</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rc5"><span class="nav-number">4.4.</span> <span class="nav-text">rc5</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#des"><span class="nav-number">4.5.</span> <span class="nav-text">des</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>

  
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_uv"></span>
</span>
</div>

<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>



<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共49.9k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  









<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>



  





  

  

  

  
  

  

  

  

</body>
</html>

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>
